import{r as n,o as Q,a as V,j as e,d as u,b as x,R as Y,l as T,k as B,H as $,g as q,s as h,c as J}from"./index-BdFt6IAq.js";function X(){const[t,r]=n.useState(null),[a,m]=n.useState(!0);return n.useEffect(()=>{const o=Q(V,c=>{r(c),m(!1)});return()=>o()},[]),{user:t,loading:a}}function Z({msg:t}){const[r,a]=n.useState(!1);return n.useEffect(()=>{a(!!t),t&&setTimeout(()=>a(!1),3e3)},[t]),!r||!t?null:e.jsx("div",{className:"fixed bottom-5 left-1/2 -translate-x-1/2 bg-slate-900 text-white px-4 py-2 rounded-xl shadow",children:t})}const ee={ANALYSIS_FAILED:"We couldn't analyze this scan. Try brighter lighting or clearer angles.",UPLOAD_FAILED:"Upload interrupted. Check your connection and retry.",AUTH_REQUIRED:"Please sign in to continue."};function se(t){const r=typeof(t==null?void 0:t.message)=="string"?t.message:"";return ee[r]??"Something went wrong. Please try again."}function te(){return e.jsxs("div",{className:"rounded-2xl border border-slate-200 p-4 bg-white",children:[e.jsx("div",{className:"font-medium mb-1",children:"Great scans = better results"}),e.jsxs("ul",{className:"list-disc ml-5 text-slate-700 space-y-1",children:[e.jsx("li",{children:"Tight clothing, neutral background, good lighting"}),e.jsx("li",{children:"Arms slightly out, camera at chest height"}),e.jsx("li",{children:"Photos: front, left, back, right"}),e.jsx("li",{children:"Video: slow 360° in 10s"})]})]})}function le(){const{user:t}=X(),[r,a]=n.useState(1),[m,o]=n.useState(null),[c,L]=n.useState([]),[g,b]=n.useState(),[j,D]=n.useState(""),[f,P]=n.useState(),[p,v]=n.useState(),[N,U]=n.useState(),[y,I]=n.useState(""),[w,W]=n.useState(""),[S,F]=n.useState("photos"),[C,H]=n.useState(10),[k,K]=n.useState("morning"),[M,O]=n.useState(!1),d=n.useMemo(()=>t?u(x,"users",t.uid):null,[t]),A=n.useMemo(()=>t?u(x,"users",t.uid,"profile","profile"):null,[t]),E=n.useMemo(()=>t?u(x,"users",t.uid,"settings","settings"):null,[t]),R=n.useMemo(()=>t?u(x,"users",t.uid,"preferences","preferences"):null,[t]);async function _(){var l,i;if(!t||!d)return;const s=await q(d);s.exists()&&((i=(l=s.data())==null?void 0:l.onboarding)!=null&&i.complete)&&o("Onboarding already completed.")}Y.useEffect(()=>{_().catch(()=>{})},[d]);function z(s,l){return s.includes(l)?s.filter(i=>i!==l):[...s,l]}async function G(){try{if(!t||!d||!A||!E||!R)throw new Error("AUTH_REQUIRED");if(!M)throw new Error("Please grant consent to continue.");const s={sexAtBirth:y||void 0,heightCm:f??void 0,weightKg:p??void 0,age:N??void 0,units:"Imperial",experience:j||void 0,goals:c,targetWeightKg:g??void 0,activityLevel:w||void 0},l={reminderDays:C,reminderTime:k},i={scanMode:S};await Promise.all([h(A,s,{merge:!0}),h(E,l,{merge:!0}),h(R,i,{merge:!0}),h(d,{onboarding:{complete:!0,completedAt:J()}},{merge:!0})]),o("Onboarding saved.")}catch(s){o(se(s))}}return e.jsxs("div",{className:"max-w-xl mx-auto p-5 space-y-4",children:[e.jsx(Z,{msg:m}),r===1&&e.jsxs("div",{className:"rounded-2xl border p-5 bg-white space-y-2",children:[e.jsx("h1",{className:"text-xl font-semibold",children:"Welcome to MyBodyScan"}),e.jsx("p",{className:"text-slate-600",children:"We'll personalize your plan in under a minute."}),e.jsx("button",{className:"mt-3 px-4 py-2 rounded-xl bg-blue-600 text-white",onClick:()=>a(2),children:"Let's go"})]}),r===2&&e.jsxs("div",{className:"rounded-2xl border p-5 bg-white space-y-3",children:[e.jsx("h2",{className:"font-medium",children:"Your goals"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:["Weight loss","Muscle gain","Recomposition","Track health metrics","Athletic performance","Post-injury comeback"].map(s=>e.jsx("button",{onClick:()=>L(z(c,s)),className:`px-3 py-1 rounded-full border ${c.includes(s)?"bg-blue-600 text-white":"bg-white text-slate-800"}`,children:s},s))}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("label",{className:"text-sm",children:["Target weight (lb)",e.jsx("input",{type:"number",className:"mt-1 w-full border rounded-lg px-3 py-2",value:g!=null?Math.round(B(g)):"",onChange:s=>{if(s.target.value===""){b(void 0);return}const l=Number(s.target.value);Number.isNaN(l)||b(T(l))}})]}),e.jsxs("label",{className:"text-sm",children:["Experience",e.jsxs("select",{className:"mt-1 w-full border rounded-lg px-3 py-2",value:j,onChange:s=>D(s.target.value),children:[e.jsx("option",{value:"",children:"Select"}),e.jsx("option",{children:"Beginner"}),e.jsx("option",{children:"Intermediate"}),e.jsx("option",{children:"Advanced"})]})]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("button",{className:"px-4 py-2 rounded-xl border",onClick:()=>a(1),children:"Back"}),e.jsx("button",{className:"px-4 py-2 rounded-xl bg-blue-600 text-white",onClick:()=>a(3),children:"Next"})]})]}),r===3&&e.jsxs("div",{className:"rounded-2xl border p-5 bg-white space-y-3",children:[e.jsx("h2",{className:"font-medium",children:"Basics"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("label",{className:"text-sm",children:["Height",e.jsx("div",{className:"mt-1",children:e.jsx($,{valueCm:f,onChangeCm:s=>P(s??void 0)})})]}),e.jsxs("label",{className:"text-sm",children:["Current weight (lb)",e.jsx("input",{type:"number",className:"mt-1 w-full border rounded-lg px-3 py-2",value:p!=null?Math.round(B(p)):"",onChange:s=>{if(s.target.value===""){v(void 0);return}const l=Number(s.target.value);Number.isNaN(l)||v(T(l))}})]}),e.jsxs("label",{className:"text-sm",children:["Age",e.jsx("input",{type:"number",className:"mt-1 w-full border rounded-lg px-3 py-2",value:N??"",onChange:s=>U(s.target.value?Number(s.target.value):void 0)})]}),e.jsxs("label",{className:"text-sm",children:["Sex at birth",e.jsxs("select",{className:"mt-1 w-full border rounded-lg px-3 py-2",value:y,onChange:s=>I(s.target.value),children:[e.jsx("option",{value:"",children:"Select"}),e.jsx("option",{value:"M",children:"M"}),e.jsx("option",{value:"F",children:"F"}),e.jsx("option",{children:"Prefer not"})]})]}),e.jsxs("label",{className:"text-sm",children:["Weekly activity",e.jsxs("select",{className:"mt-1 w-full border rounded-lg px-3 py-2",value:w,onChange:s=>W(s.target.value),children:[e.jsx("option",{value:"",children:"Select"}),e.jsx("option",{children:"Low"}),e.jsx("option",{children:"Med"}),e.jsx("option",{children:"High"})]})]}),e.jsxs("label",{className:"text-sm",children:["Preferred units",e.jsx("div",{className:"mt-1 w-full border rounded-lg px-3 py-2 bg-slate-50 text-slate-600",children:"US (lb, ft/in) — defaults for v1"})]}),e.jsxs("label",{className:"text-sm",children:["Scan mode",e.jsxs("select",{className:"mt-1 w-full border rounded-lg px-3 py-2",value:S,onChange:s=>F(s.target.value),children:[e.jsx("option",{value:"photos",children:"Photos (4 angles)"}),e.jsx("option",{value:"video",children:"10s Video"})]})]})]}),e.jsx(te,{}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("button",{className:"px-4 py-2 rounded-xl border",onClick:()=>a(2),children:"Back"}),e.jsx("button",{className:"px-4 py-2 rounded-xl bg-blue-600 text-white",onClick:()=>a(4),children:"Next"})]})]}),r===4&&e.jsxs("div",{className:"rounded-2xl border p-5 bg-white space-y-3",children:[e.jsx("h2",{className:"font-medium",children:"Reminders & Consent"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("label",{className:"text-sm",children:["Reminder cadence",e.jsxs("select",{className:"mt-1 w-full border rounded-lg px-3 py-2",value:C,onChange:s=>H(Number(s.target.value)),children:[e.jsx("option",{value:7,children:"Every 7 days"}),e.jsx("option",{value:10,children:"Every 10 days"}),e.jsx("option",{value:14,children:"Every 14 days"})]})]}),e.jsxs("label",{className:"text-sm",children:["Time of day",e.jsxs("select",{className:"mt-1 w-full border rounded-lg px-3 py-2",value:k,onChange:s=>K(s.target.value),children:[e.jsx("option",{value:"morning",children:"Morning"}),e.jsx("option",{value:"afternoon",children:"Afternoon"}),e.jsx("option",{value:"evening",children:"Evening"})]})]})]}),e.jsxs("label",{className:"inline-flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:M,onChange:s=>O(s.target.checked)}),e.jsx("span",{children:"I consent to store my scans to track progress."})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("button",{className:"px-4 py-2 rounded-xl border",onClick:()=>a(3),children:"Back"}),e.jsx("button",{className:"px-4 py-2 rounded-xl bg-blue-600 text-white",onClick:G,children:"Finish"})]})]})]})}export{le as default};
